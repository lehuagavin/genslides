# Docker éƒ¨ç½²é…ç½®å·²å®Œæˆ âœ“

## ğŸ“¦ å·²åˆ›å»ºçš„æ–‡ä»¶

### æ ¹ç›®å½•
- âœ… `Makefile` - éƒ¨ç½²ç®¡ç†å‘½ä»¤ï¼ˆæ”¯æŒ make deploy, build, restart, logs, statusç­‰ï¼‰
- âœ… `docker-compose.yml` - Docker Compose ç¼–æ’é…ç½®
- âœ… `DOCKER.md` - è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
- âœ… `quick-start.sh` - ä¸€é”®å¿«é€Ÿå¯åŠ¨è„šæœ¬
- âœ… `test-deployment.sh` - éƒ¨ç½²éªŒè¯æµ‹è¯•è„šæœ¬

### Backend
- âœ… `backend/Dockerfile` - åç«¯å®¹å™¨é•œåƒé…ç½®ï¼ˆPython 3.12 + FastAPIï¼‰
- âœ… `backend/.dockerignore` - æ„å»ºæ—¶å¿½ç•¥æ–‡ä»¶

### Frontend
- âœ… `frontend/Dockerfile` - å‰ç«¯å®¹å™¨é•œåƒé…ç½®ï¼ˆå¤šé˜¶æ®µæ„å»ºï¼ŒNode.js + Nginxï¼‰
- âœ… `frontend/.dockerignore` - æ„å»ºæ—¶å¿½ç•¥æ–‡ä»¶
- âœ… `frontend/nginx.conf` - Nginx åå‘ä»£ç†é…ç½®

### æ›´æ–°çš„æ–‡ä»¶
- âœ… `README.md` - æ·»åŠ äº† Docker éƒ¨ç½²å¿«é€Ÿå…¥é—¨
- âœ… `.gitignore` - æ·»åŠ äº† Docker ç›¸å…³å¿½ç•¥è§„åˆ™

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä½¿ç”¨å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
# è¿è¡Œäº¤äº’å¼å¯åŠ¨è„šæœ¬
./quick-start.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æ£€æŸ¥ Docker å’Œ Docker Compose æ˜¯å¦å®‰è£…
2. åˆ›å»ºå¹¶é…ç½® `.env` æ–‡ä»¶
3. åˆ›å»ºå¿…è¦çš„ç›®å½•
4. æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
5. éªŒè¯æœåŠ¡å¥åº·çŠ¶æ€

### æ–¹å¼äºŒï¼šä½¿ç”¨ Makefileï¼ˆæ¨èç†Ÿç»ƒç”¨æˆ·ï¼‰

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env  # æ·»åŠ ä½ çš„ API keys

# 2. ä¸€é”®éƒ¨ç½²
make deploy

# 3. æŸ¥çœ‹çŠ¶æ€
make status
```

### æ–¹å¼ä¸‰ï¼šç›´æ¥ä½¿ç”¨ Docker Compose

```bash
# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env

# æ„å»ºå¹¶å¯åŠ¨
docker compose up -d --build

# æŸ¥çœ‹çŠ¶æ€
docker compose ps
```

## ğŸ“‹ Makefile å‘½ä»¤é€ŸæŸ¥

### æ ¸å¿ƒå‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `make deploy` | é‡æ–°ç¼–è¯‘å¹¶éƒ¨ç½² | `make deploy` |
| `make deploy SERVICE=backend` | åªéƒ¨ç½²åç«¯ | `make deploy SERVICE=backend` |
| `make build` | é‡æ–°ç¼–è¯‘é•œåƒ | `make build` |
| `make restart` | é‡å¯æœåŠ¡ | `make restart SERVICE=frontend` |
| `make logs` | æŸ¥çœ‹æ—¥å¿— | `make logs SERVICE=backend` |
| `make status` | æŸ¥çœ‹æœåŠ¡çŠ¶æ€ | `make status` |
| `make help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `make help` |

### è¿ç»´å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make start` | å¯åŠ¨å·²åœæ­¢çš„æœåŠ¡ |
| `make stop` | åœæ­¢æœåŠ¡ |
| `make up` | åˆ›å»ºå¹¶å¯åŠ¨æœåŠ¡ |
| `make down` | åœæ­¢å¹¶åˆ é™¤æœåŠ¡ |
| `make health` | æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€ |
| `make clean` | æ¸…ç†æ‰€æœ‰å®¹å™¨å’Œé•œåƒ |

### å¼€å‘è°ƒè¯•

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make dev` | å¼€å‘æ¨¡å¼å¯åŠ¨ï¼ˆæ˜¾ç¤ºæ—¥å¿—ï¼‰|
| `make shell-backend` | è¿›å…¥åç«¯å®¹å™¨ shell |
| `make shell-frontend` | è¿›å…¥å‰ç«¯å®¹å™¨ shell |

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### æœåŠ¡é…ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Docker Compose                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Frontend   â”‚    â”‚   Backend    â”‚  â”‚
â”‚  â”‚              â”‚    â”‚              â”‚  â”‚
â”‚  â”‚  React App   â”‚â”€â”€â”€â–¶â”‚   FastAPI    â”‚  â”‚
â”‚  â”‚    Nginx     â”‚    â”‚  Python 3.12 â”‚  â”‚
â”‚  â”‚   Port 80    â”‚    â”‚  Port 3003   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚            â”‚
â”‚                            â–¼            â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                      â”‚  Slides  â”‚       â”‚
â”‚                      â”‚   Data   â”‚       â”‚
â”‚                      â”‚  Volume  â”‚       â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç«¯å£æ˜ å°„

- **Frontend**: `http://localhost` (80)
- **Backend**: `http://localhost:3003` (3003)

### æ•°æ®æŒä¹…åŒ–

- `./slides` ç›®å½•æŒ‚è½½åˆ°åç«¯å®¹å™¨çš„ `/app/slides`
- æ‰€æœ‰ç”Ÿæˆçš„å¹»ç¯ç‰‡æ•°æ®æŒä¹…åŒ–åœ¨ä¸»æœº

### ç½‘ç»œ

- ä½¿ç”¨ Docker bridge ç½‘ç»œ `genslides-network`
- æœåŠ¡é—´é€šè¿‡æœåŠ¡åé€šä¿¡ï¼ˆå¦‚ï¼š`http://backend:3003`ï¼‰

### å¥åº·æ£€æŸ¥

- **Backend**: HTTP GET `/health` (30ç§’é—´éš”)
- **Frontend**: HTTP GET `/health` (30ç§’é—´éš”)

## ğŸ§ª éªŒè¯éƒ¨ç½²

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯éƒ¨ç½²çŠ¶æ€ï¼š

```bash
./test-deployment.sh
```

æµ‹è¯•å†…å®¹åŒ…æ‹¬ï¼š
1. âœ“ å®¹å™¨è¿è¡ŒçŠ¶æ€
2. âœ“ åç«¯å¥åº·æ£€æŸ¥
3. âœ“ å‰ç«¯å¥åº·æ£€æŸ¥
4. âœ“ API ç«¯ç‚¹å¯è®¿é—®æ€§
5. âœ“ å‰ç«¯é¡µé¢å“åº”
6. âœ“ æ•°æ®å·æŒ‚è½½
7. âœ“ æœåŠ¡é—´ç½‘ç»œè¿é€šæ€§

## ğŸ“š è¯¦ç»†æ–‡æ¡£

æŸ¥çœ‹ [DOCKER.md](./DOCKER.md) è·å–ï¼š
- å®Œæ•´çš„éƒ¨ç½²æŒ‡å—
- ç”Ÿäº§ç¯å¢ƒé…ç½®
- æ•…éšœæ’æŸ¥
- å¤‡ä»½å’Œæ¢å¤
- æ›´æ–°å‡çº§æµç¨‹

## ğŸ”§ å¸¸è§æ“ä½œ

### æŸ¥çœ‹æ—¥å¿—

```bash
# æ‰€æœ‰æœåŠ¡
make logs

# åªçœ‹åç«¯
make logs SERVICE=backend

# å®æ—¶è·Ÿè¸ª
docker compose logs -f backend
```

### é‡å¯æœåŠ¡

```bash
# æ‰€æœ‰æœåŠ¡
make restart

# åªé‡å¯åç«¯
make restart SERVICE=backend
```

### æ›´æ–°ä»£ç åé‡æ–°éƒ¨ç½²

```bash
git pull
make deploy
```

### è¿›å…¥å®¹å™¨è°ƒè¯•

```bash
# åç«¯å®¹å™¨
make shell-backend

# å‰ç«¯å®¹å™¨
make shell-frontend
```

### æ¸…ç†å¹¶é‡æ–°å¼€å§‹

```bash
make clean  # ä¼šæç¤ºç¡®è®¤
make deploy
```

## âš™ï¸ ç¯å¢ƒå˜é‡

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š

```bash
# VolcEngine API (æ¨èï¼Œé»˜è®¤å¼•æ“)
ARK_API_KEY=your_ark_api_key_here

# Google Gemini API (å¯é€‰)
GEMINI_API_KEY=your_gemini_api_key_here

# æœåŠ¡å™¨é…ç½®
SERVER_HOST=0.0.0.0
SERVER_PORT=3003
SLIDES_BASE_PATH=/app/slides

# CORSï¼ˆç”Ÿäº§ç¯å¢ƒéœ€è¦ä¿®æ”¹ï¼‰
CORS_ORIGINS=http://localhost,http://localhost:80
```

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **é…ç½® API Keys**: ç¼–è¾‘ `.env` æ·»åŠ ä½ çš„ API å¯†é’¥
2. **å¯åŠ¨æœåŠ¡**: è¿è¡Œ `make deploy` æˆ– `./quick-start.sh`
3. **è®¿é—®åº”ç”¨**: æ‰“å¼€ http://localhost
4. **éªŒè¯éƒ¨ç½²**: è¿è¡Œ `./test-deployment.sh`
5. **æŸ¥çœ‹æ–‡æ¡£**: é˜…è¯» [DOCKER.md](./DOCKER.md) äº†è§£æ›´å¤š

## ğŸ’¡ æç¤º

- ä½¿ç”¨ `make help` æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
- ä½¿ç”¨ `make status` éšæ—¶æŸ¥çœ‹æœåŠ¡çŠ¶æ€
- ä½¿ç”¨ `make logs` æ’æŸ¥é—®é¢˜
- ç”Ÿäº§éƒ¨ç½²å‰è¯·é˜…è¯» [DOCKER.md](./DOCKER.md) çš„ç”Ÿäº§ç¯å¢ƒç« èŠ‚

## ğŸ› é—®é¢˜æ’æŸ¥

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æ—¥å¿—ï¼š`make logs`
2. æ£€æŸ¥çŠ¶æ€ï¼š`make status`
3. éªŒè¯å¥åº·ï¼š`make health`
4. è¿è¡Œæµ‹è¯•ï¼š`./test-deployment.sh`
5. æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š[DOCKER.md](./DOCKER.md)

---

**å¼€å§‹ä½¿ç”¨**: `./quick-start.sh` æˆ– `make deploy`
